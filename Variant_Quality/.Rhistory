dat_pheno_cov_dosage_tbl <- cbind(cbind(dat_pheno_cov_tbl,data.frame(rs2296651 = snp_dosage_data,stringsAsFactors = F)),pos_17,pos_35,pos_51)
dat_pheno_cov_tbl
dat_covar_joined_ordered
dat_alternative_outcome_ordered
dat_covars_raw
load('~/Documents/G2G_HBV/data/results_POP_asian_GT_A_C_D_B_TYPE_pPCA_LOCO_FALSE/setup.rda')
load('~/Documents/G2G_HBV/data/results_POP_asian_GT_A_C_D_B_TYPE_pPCA_LOCO_FALSE/prep-data.rda')
source('~/.active-rstudio-document', echo=TRUE)
pos_17
pos_35
pos_51
pos_35
dim(pos_17)
dim(pos_35)
dim(pos_51)
dim(dat_pheno_cov_tbl)
dim(snp_dosage_data)
snp_dosage_data
length(snp_dosage_data)
#Load dosage of rs2296651
saige_vcf <- glue::glue("{DIR_PROCESSED}/hbv_gilead_QC_SAIGE.vcf.gz")
system(glue::glue("bcftools query -f '%CHROM %POS %ID %REF %ALT\n' {saige_vcf} > {saige_vcf}.pos"))
rs2296651_pos <- dplyr::filter(pos_info,V3 == "rs2296651")
snp_dosage_data <- data.table::fread(text = system(glue::glue('bcftools view -r {rs2296651_pos$V1}:{rs2296651_pos$V2} {saige_vcf} | bcftools +dosage -- -t "GT"'),intern = T))
snp_dosage_data
colnames(snp_dosage_data) <- sapply(colnames(snp_dosage_data),function(x) gsub(x=x,pattern = "\\[.*\\]", replacement = "",))
#Remove descript columns
ind_to_keep <- which(!colnames(snp_dosage_data) %in% c('#CHROM','POS','REF','ALT'))
snp_dosage_data <- snp_dosage_data[,..ind_to_keep]
snp_dosage_data
#Parse IDs
snp_dosage_samples <- sapply(colnames(snp_dosage_data),function(x) strsplit(x,split = '_')[[1]][1])
snp_dosage_samples
snp_dosage_data <- as.vector(as.numeric(snp_dosage_data))
names(snp_dosage_data) <- snp_dosage_samples
colnames(top_hits_aa_dosage)
#Make sure ordering of sample is same
snp_dosage_data <- snp_dosage_data[match(colnames(top_hits_aa_dosage),names(snp_dosage_data))]
snp_dosage_data
names(snp_dosage_data)
colnames(top_hits_aa_dosage)
#Load dosage of rs2296651
saige_vcf <- glue::glue("{DIR_PROCESSED}/hbv_gilead_QC_SAIGE.vcf.gz")
system(glue::glue("bcftools query -f '%CHROM %POS %ID %REF %ALT\n' {saige_vcf} > {saige_vcf}.pos"))
rs2296651_pos <- dplyr::filter(pos_info,V3 == "rs2296651")
snp_dosage_data <- data.table::fread(text = system(glue::glue('bcftools view -r {rs2296651_pos$V1}:{rs2296651_pos$V2} {saige_vcf} | bcftools +dosage -- -t "GT"'),intern = T))
colnames(snp_dosage_data) <- sapply(colnames(snp_dosage_data),function(x) gsub(x=x,pattern = "\\[.*\\]", replacement = "",))
#Remove descript columns
ind_to_keep <- which(!colnames(snp_dosage_data) %in% c('#CHROM','POS','REF','ALT'))
snp_dosage_data <- snp_dosage_data[,..ind_to_keep]
#Parse IDs
snp_dosage_samples <- sapply(colnames(snp_dosage_data),function(x) strsplit(x,split = '_')[[1]][1])
snp_dosage_data <- as.vector(as.numeric(snp_dosage_data))
names(snp_dosage_data) <- snp_dosage_samples
snp_dosage_samples
intersect(snp_dosage_samples,colnames(top_hits_aa_dosage))
intersect(snp_dosage_samples,colnames(top_hits_aa_dosage))DIR_PROCESSED
DIR_PROCESSED
saige_pheno$ID
dat_pathogen$ID
dat_pathogen_asn$ID
sig_hits$HBV_AA
colnames(top_hits_aa_dosage)
top_hits_aa_dosage
dim(top_hits_aa_dosage)
intersect(dat_pathogen_asn$ID,snp_dosage_samples)
saige_vcf
saige_vcf
pos_info
snp_dosage_data
snp_dosage_data <- data.table::fread(text = system(glue::glue('bcftools view -r {rs2296651_pos$V1}:{rs2296651_pos$V2} {saige_vcf} | bcftools +dosage -- -t "GT"'),intern = T))
colnames(snp_dosage_data) <- sapply(colnames(snp_dosage_data),function(x) gsub(x=x,pattern = "\\[.*\\]", replacement = "",))
snp_dosage_data
#Remove descript columns
ind_to_keep <- which(!colnames(snp_dosage_data) %in% c('#CHROM','POS','REF','ALT'))
snp_dosage_data <- snp_dosage_data[,..ind_to_keep]
snp_dosage_data
#Parse IDs
snp_dosage_samples <- sapply(colnames(snp_dosage_data),function(x) strsplit(x,split = '_')[[1]][1])
snp_dosage_samples
length(intersect(snp_dosage_samples,colnames(top_hits_aa_dosage)))
length(intersect(dat_pathogen_asn$ID,colnames(top_hits_aa_dosage)))
dat_pathogen_asn[,sig_hits$HBV_AA]
dim(t(dat_pathogen_asn[,sig_hits$HBV_AA]))
dim(as.matrix(t(dat_pathogen_asn[,sig_hits$HBV_AA])))
length(intersect(snp_dosage_samples,dat_pathogen$ID))
length(intersect(snp_dosage_samples,dat_pathogen_asn$ID))
saige_pheno
saige_pheno$ID
length(intersect(saige_pheno$ID,dat_pathogen$ID))
length(intersect(dat_pathogen_asn$ID,dat_pathogen$ID))
match(saige_pheno$ID,dat_pathogen$ID)
dat_pathogen$ID
dat_pathogen_raw
dat_pathogen_raw$ID
dat_pathogen_asn <- dat_pathogen_raw[match(saige_pheno$ID,dat_pathogen_raw$ID),]
length(intersect(dat_pathogen_asn$ID,dat_pathogen$ID))
length(intersect(dat_pathogen_asn$ID,saige_pheno$ID))
dat_pathogen_asn <- dat_pathogen_raw[match(saige_pheno$ID,dat_pathogen_raw$ID),]
match(saige_pheno$ID,dat_pathogen_raw$ID)
dat_pathogen_asn <- dat_pathogen_raw[match(saige_pheno$ID,dat_pathogen_raw$ID),]
pos_17 <- cbind(dat_pathogen_asn$gene_S_pos_0017_A,dat_pathogen_asn$gene_S_pos_0017_S,dat_pathogen_asn$gene_S_pos_0017_STOP,dat_pathogen_asn$gene_S_pos_0017_Y)
colnames(pos_17) <- c('gene_S_pos_0017_A','gene_S_pos_0017_S','gene_S_pos_0017_STOP','gene_S_pos_0017_Y')
pos_51 <- cbind(dat_pathogen_asn$gene_S_pos_0051_H,dat_pathogen_asn$gene_S_pos_0051_I,dat_pathogen_asn$gene_S_pos_0051_K,dat_pathogen_asn$gene_S_pos_0051_N,dat_pathogen_asn$gene_S_pos_0051_P,dat_pathogen_asn$gene_S_pos_0051_Q,dat_pathogen_asn$gene_S_pos_0051_R,dat_pathogen_asn$gene_S_pos_0051_S,dat_pathogen_asn$gene_S_pos_0051_T,dat_pathogen_asn$gene_S_pos_0051_Y)
colnames(pos_51) <- c('gene_S_pos_0051_H','gene_S_pos_0051_I','gene_S_pos_0051_K','gene_S_pos_0051_N','gene_S_pos_0051_P','gene_S_pos_0051_Q','gene_S_pos_0051_R','gene_S_pos_0051_S','gene_S_pos_0051_T','gene_S_pos_0051_Y')
pos_35 <- cbind(dat_pathogen_asn$gene_S_pos_0035_E,dat_pathogen_asn$gene_S_pos_0035_G,dat_pathogen_asn$gene_S_pos_0035_K,dat_pathogen_asn$gene_S_pos_0035_R,dat_pathogen_asn$gene_S_pos_0035_T)
colnames(pos_35) <- c('gene_S_pos_0035_E','gene_S_pos_0035_G','gene_S_pos_0035_K','gene_S_pos_0035_R','gene_S_pos_0035_T')
top_hits_aa_dosage <- as.matrix(t(dat_pathogen_asn[,sig_hits$HBV_AA]))
colnames(top_hits_aa_dosage) <- dat_pathogen_asn$ID
#Load dosage of rs2296651
saige_vcf <- glue::glue("{DIR_PROCESSED}/hbv_gilead_QC_SAIGE.vcf.gz")
system(glue::glue("bcftools query -f '%CHROM %POS %ID %REF %ALT\n' {saige_vcf} > {saige_vcf}.pos"))
rs2296651_pos <- dplyr::filter(pos_info,V3 == "rs2296651")
snp_dosage_data <- data.table::fread(text = system(glue::glue('bcftools view -r {rs2296651_pos$V1}:{rs2296651_pos$V2} {saige_vcf} | bcftools +dosage -- -t "GT"'),intern = T))
colnames(snp_dosage_data) <- sapply(colnames(snp_dosage_data),function(x) gsub(x=x,pattern = "\\[.*\\]", replacement = "",))
#Remove descript columns
ind_to_keep <- which(!colnames(snp_dosage_data) %in% c('#CHROM','POS','REF','ALT'))
snp_dosage_data <- snp_dosage_data[,..ind_to_keep]
#Parse IDs
snp_dosage_samples <- sapply(colnames(snp_dosage_data),function(x) strsplit(x,split = '_')[[1]][1])
snp_dosage_data <- as.vector(as.numeric(snp_dosage_data))
names(snp_dosage_data) <- snp_dosage_samples
#Make sure ordering of sample is same
snp_dosage_data <- snp_dosage_data[match(colnames(top_hits_aa_dosage),names(snp_dosage_data))]
#Match ordering of pheno file
dat_covar_joined <- dplyr::inner_join(dat_covars_discrete,dat_covars_numeric)
dat_covar_joined_ordered <- dat_covar_joined[match(names(snp_dosage_data),dat_covar_joined$host_id),]
dat_alternative_outcome_ordered <- dat_alternative_outcome[match(names(snp_dosage_data),dat_alternative_outcome$host_id),]
dat_pheno_cov_tbl <- dplyr::inner_join(dat_covar_joined_ordered,dat_alternative_outcome_ordered) %>% dplyr::left_join(dat_covars_raw %>% dplyr::select('host_id','BASELINE_HBEAG_STATUS'),by=c('host_id'='host_id'))
dat_pheno_cov_dosage_tbl <- cbind(cbind(dat_pheno_cov_tbl,data.frame(rs2296651 = snp_dosage_data,stringsAsFactors = F)),pos_17,pos_35,pos_51)
dat_pheno_cov_dosage_tbl$BASELINE_HBEAG_STATUS <- as.factor(dat_pheno_cov_dosage_tbl$BASELINE_HBEAG_STATUS)
dat_pheno_cov_dosage_tbl$gene_S_pos_0051_P_grp <- factor(paste0(dat_pheno_cov_dosage_tbl$rs2296651,dat_pheno_cov_dosage_tbl$gene_S_pos_0051_P))
dat_pheno_cov_dosage_tbl$gene_S_pos_0017_A_grp <- factor(paste0(dat_pheno_cov_dosage_tbl$rs2296651,dat_pheno_cov_dosage_tbl$gene_S_pos_0017_A))
dat_pheno_cov_dosage_tbl$gene_S_pos_0035_R_grp <- factor(paste0(dat_pheno_cov_dosage_tbl$rs2296651,dat_pheno_cov_dosage_tbl$gene_S_pos_0035_R))
dat_pheno_cov_dosage_tbl_recode <- dat_pheno_cov_dosage_tbl
dat_pheno_cov_dosage_tbl_recode$surface_antigen_invnormal_residual <- residuals(lm('surface_antigen_invnormal ~ AGE + SEX + pPC1 + pPC2 + pPC4 + pPC4 + pPC5 + pPC6 + host_PC1 + host_PC2 + host_PC3 + host_PC4',data = dat_pheno_cov_dosage_tbl_recode))
dat_pheno_cov_dosage_tbl_recode$ALT_level_invnormal_residual <- residuals(lm('ALT_level_invnormal ~ AGE + SEX + pPC1 + pPC2 + pPC4 + pPC4 + pPC5 + pPC6 + host_PC1 + host_PC2 + host_PC3 + host_PC4',data = dat_pheno_cov_dosage_tbl_recode))
dat_pheno_cov_dosage_tbl_recode$viralload_merged_invnormal_residual <- dat_pheno_cov_dosage_tbl_recode$viralload_merged_invnormal
dat_pheno_cov_dosage_tbl_recode$viralload_merged_invnormal_residual[!is.na(dat_pheno_cov_dosage_tbl_recode$viralload_merged_invnormal)] <- residuals(lm('viralload_merged_invnormal ~ AGE + SEX + pPC1 + pPC2 + pPC4 + pPC4 + pPC5 + pPC6 + host_PC1 + host_PC2 + host_PC3 + host_PC4',data = dat_pheno_cov_dosage_tbl_recode))
my_comparisons <- list(c("00", "10"), c("00", "11"), c("10", "11"))
p1 <- ggboxplot(data = dat_pheno_cov_dosage_tbl_recode %>% dplyr::filter(gene_S_pos_0017_A_grp != '0NA') %>% dplyr::filter(!is.na(surface_antigen_invnormal_residual)), x = 'gene_S_pos_0017_A_grp', y = 'surface_antigen_invnormal_residual', palette = "jco",
add = "jitter",add.params	= list(size=0.3),outlier.shape = NA) + stat_compare_means(comparisons = my_comparisons,method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('HBsAg Level') + ggtitle('PreS1 (Pos 17)') + scale_x_discrete(labels = c('GG\nNon-Ala','GG\nAla','GA\nNon-Ala','GA\nAla'))+ theme(text = element_text(size=11))+ theme(axis.text.x = element_text(size = 10))
p2 <- ggboxplot(data = dat_pheno_cov_dosage_tbl_recode %>% dplyr::filter(gene_S_pos_0017_A_grp != '0NA') %>% dplyr::filter(!is.na(viralload_merged_invnormal_residual)), x = 'gene_S_pos_0017_A_grp', y = 'viralload_merged_invnormal_residual', palette = "jco",
add = "jitter",add.params	= list(size=0.3),outlier.shape = NA) + stat_compare_means(comparisons = my_comparisons,method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load') + scale_x_discrete(labels = c('GG\nNon-Ala','GG\nAla','GA\nNon-Ala','GA\nAla'))+ theme(text = element_text(size=11))+ theme(axis.text.x = element_text(size = 10))
p4 <- ggboxplot(data = dat_pheno_cov_dosage_tbl_recode %>% dplyr::filter(!is.na(surface_antigen_invnormal_residual)), x = 'gene_S_pos_0051_P_grp', y = 'surface_antigen_invnormal_residual', palette = "jco",
add = "jitter",add.params	= list(size=0.3),outlier.shape = NA) + stat_compare_means(comparisons = my_comparisons,method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('') + ggtitle('PreS1 (Pos 51)') + scale_x_discrete(labels = c('GG\nNon-Pro','GG\nPro','GA\nNon-Pro','GA\nPro')) + theme(text = element_text(size=11))+ theme(axis.text.x = element_text(size = 10))
p5 <- ggboxplot(data = dat_pheno_cov_dosage_tbl_recode %>% dplyr::filter(!is.na(viralload_merged_invnormal_residual)), x = 'gene_S_pos_0051_P_grp', y = 'viralload_merged_invnormal_residual', palette = "jco",
add = "jitter",add.params	= list(size=0.3),outlier.shape = NA) + stat_compare_means(comparisons = my_comparisons,method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('')+ scale_x_discrete(labels = c('GG\nNon-Pro','GG\nPro','GA\nNon-Pro','GA\nPro')) + theme(text = element_text(size=11))+ theme(axis.text.x = element_text(size = 10))
p6 <- ggboxplot(data = dat_pheno_cov_dosage_tbl_recode, x = 'gene_S_pos_0051_P_grp', y = 'ALT_level_invnormal_residual', palette = "jco",
add = "jitter",add.params	= list(size=0.3),outlier.shape = NA) + stat_compare_means(comparisons = my_comparisons,method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('')+ scale_x_discrete(labels = c('GG\nNon-Pro','GG\nPro','GA\nNon-Pro','GA\nPro')) + theme(text = element_text(size=11))+ theme(axis.text.x = element_text(size = 10))
my_comparisons <- list(c("00", "10"), c("00", "11"), c("10", "11"),c("01", "00"),c("01", "10"),c("01", "11"))
p7 <- ggboxplot(data = dat_pheno_cov_dosage_tbl_recode %>% dplyr::filter(!is.na(surface_antigen_invnormal_residual)), x = 'gene_S_pos_0035_R_grp', y = 'surface_antigen_invnormal_residual', palette = "jco",
add = "jitter",add.params	= list(size=0.3),outlier.shape = NA) + stat_compare_means(comparisons = my_comparisons,method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('') + ggtitle('PreS1 (Pos 35)') + scale_x_discrete(labels = c('GG\nNon-Arg','GG\nArg','GA\nNon-Arg','GA\nArg'))+ theme(text = element_text(size=11))+ theme(axis.text.x = element_text(size = 10))
p8 <- ggboxplot(data = dat_pheno_cov_dosage_tbl_recode %>% dplyr::filter(!is.na(viralload_merged_invnormal_residual)), x = 'gene_S_pos_0035_R_grp', y = 'viralload_merged_invnormal_residual', palette = "jco",
add = "jitter",add.params	= list(size=0.3),outlier.shape = NA) + stat_compare_means(comparisons = my_comparisons,method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('')+ scale_x_discrete(labels = c('GG\nNon-Arg','GG\nArg','GA\nNon-Arg','GA\nArg'))+ theme(text = element_text(size=11))+ theme(axis.text.x = element_text(size = 10))
p9 <- ggboxplot(data = dat_pheno_cov_dosage_tbl_recode %>% dplyr::filter(!is.na(ALT_level_invnormal_residual)), x = 'gene_S_pos_0035_R_grp', y = 'ALT_level_invnormal_residual', palette = "jco",
add = "jitter",add.params	= list(size=0.3),outlier.shape = NA) + stat_compare_means(comparisons = my_comparisons,method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('')+ scale_x_discrete(labels = c('GG\nNon-Arg','GG\nArg','GA\nNon-Arg','GA\nArg'))+ theme(text = element_text(size=11)) + theme(axis.text.x = element_text(size = 10))
ntcp_strat_plot_grp <- ggpubr::ggarrange(p1,p4,p7,p2,p5,p8,p3,p6,p9,nrow = 3,ncol = 3,font.label = list(size=12))
ntcp_strat_plot_grp
p3 <- ggboxplot(data = dat_pheno_cov_dosage_tbl_recode %>% dplyr::filter(gene_S_pos_0017_A_grp != '0NA') %>% dplyr::filter(!is.na(ALT_level_invnormal_residual)), x = 'gene_S_pos_0017_A_grp', y = 'ALT_level_invnormal_residual', palette = "jco",
add = "jitter",add.params	= list(size=0.3),outlier.shape = NA) + stat_compare_means(comparisons = my_comparisons,method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Serum Alanine Aminotransferase') + scale_x_discrete(labels = c('GG\nNon-Ala','GG\nAla','GA\nNon-Ala','GA\nAla'))+ theme(text = element_text(size=11))+ theme(axis.text.x = element_text(size = 10))
ntcp_strat_plot_grp
ntcp_strat_plot_grp <- ggpubr::ggarrange(p1,p4,p7,p2,p5,p8,p3,p6,p9,nrow = 3,ncol = 3,font.label = list(size=12))
ntcp_strat_plot_grp
source('~/.active-rstudio-document', echo=TRUE)
ntcp_strat_plot_grp
dat_pheno_cov_dosage_tbl_recode
dat_pheno_cov_dosage_tbl
#Check BLOSUM score
dat_pheno_cov_dosage_tbl_rs_pos <- dplyr::filter(dat_pheno_cov_dosage_tbl,rs2296651 == 0)
dat_pheno_cov_dosage_tbl_rs_pos
#Check BLOSUM score
dat_pheno_cov_dosage_tbl_ntcp_ref <- dplyr::filter(dat_pheno_cov_dosage_tbl,rs2296651 == 0)
dat_pheno_cov_dosage_tbl_ntcp_ref
data(BLOSUM80)
library(Biostrings)
data(BLOSUM80)
BLOSUM80
hist(BLOSUM80)
exp(BLOSUM80)
pos_35
apply(pos_35,2,sum)
pos_35_G <- dat_pheno_cov_dosage_tbl_ntcp_ref$gene_S_pos_0035_G
pos_35_K <- dat_pheno_cov_dosage_tbl_ntcp_ref$gene_S_pos_0035_K
pos_35_R <- dat_pheno_cov_dosage_tbl_ntcp_ref$gene_S_pos_0035_R
pos_35_G
pos_35_K
pos_35_R
table(pos_35_G)
table(pos_35_K)
table(pos_35_R)
dplyr::filter(dat_pheno_cov_dosage_tbl_recode$viralload_merged_invnormal_residual,gene_S_pos_0035_G==1)
dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0035_G==1 & rs2296651 == 0)
pos_35_G <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0035_G==1 & rs2296651 == 0)
pos_35_K <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0035_K==1 & rs2296651 == 0)
pos_35_R <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0035_R==1 & rs2296651 == 0)
pos_35_vl <- rbind(data.frame(Pheno = pos_35_G$viralload_merged_invnormal_residual,Residue = 'G',BLOSUM = BLOSUM80["G","G"]))
pos_35_vl
pos_35_vl <- rbind(data.frame(Pheno = pos_35_G$viralload_merged_invnormal_residual,Residue = 'G',BLOSUM = BLOSUM80["G","G"]),
data.frame(Pheno = pos_35_K$viralload_merged_invnormal_residual,Residue = 'K',BLOSUM = BLOSUM80["G","K"]),
data.frame(Pheno = pos_35_R$viralload_merged_invnormal_residual,Residue = 'R',BLOSUM = BLOSUM80["G","R"]))
pos_35_vl
ggplot2::ggplot(data = pos_35_vl) + geom_point(aes(x=BLOSUM,y=Pheno,color = residue))
ggplot2::ggplot(data = pos_35_vl) + geom_point(aes(x=BLOSUM,y=Pheno,color = residue)) + geom_point()
ggplot2::ggplot(data = pos_35_vl) + geom_point(aes(x=BLOSUM,y=Pheno,color = Residue)) + geom_point()
BLOSUM80["G","G"]
ggplot2::ggplot(data = pos_35_vl,aes(x=BLOSUM,y=Pheno,color = Residue)) + geom_point()
ggplot2::ggplot(data = pos_35_vl,aes(x=BLOSUM,y=Pheno,color = Residue)) + geom_point()
pos_35 <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,rs2296651 == 0)
pos_35_vl <- rbind(data.frame(Pheno = pos_35_G$viralload_merged_invnormal_residual - mean(pos_35$viralload_merged_invnormal_residual),Residue = 'G',BLOSUM = BLOSUM80["G","G"]),
data.frame(Pheno = pos_35_K$viralload_merged_invnormal_residual- mean(pos_35$viralload_merged_invnormal_residual),Residue = 'K',BLOSUM = BLOSUM80["G","K"]),
data.frame(Pheno = pos_35_R$viralload_merged_invnormal_residual- mean(pos_35$viralload_merged_invnormal_residual),Residue = 'R',BLOSUM = BLOSUM80["G","R"]))
ggplot2::ggplot(data = pos_35_vl,aes(x=BLOSUM,y=Pheno,color = Residue)) + geom_point()
mean(pos_35$viralload_merged_invnormal_residual)
l
pos_35_vl <- rbind(data.frame(Pheno = pos_35_G$viralload_merged_invnormal_residual - mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = 'G',BLOSUM = BLOSUM80["G","G"]),
data.frame(Pheno = pos_35_K$viralload_merged_invnormal_residual- mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = 'K',BLOSUM = BLOSUM80["G","K"]),
data.frame(Pheno = pos_35_R$viralload_merged_invnormal_residual- mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = 'R',BLOSUM = BLOSUM80["G","R"]))
ggplot2::ggplot(data = pos_35_vl,aes(x=BLOSUM,y=Pheno,color = Residue)) + geom_point()
ggplot2::ggplot(data = pos_35_vl,aes(x=BLOSUM,y=Pheno,color = Residue)) + geom_point()
pos_35_R$viralload_merged_invnormal_residual
pos_35$viralload_merged_invnormal_residual
mean(pos_35$viralload_merged_invnormal_residual,na.rm=T)
ggplot2::ggboxplot(data = pos_35_vl,aes(x=Residue,y=Pheno)) + geom_point()
ggplot2::ggboxplot(data = pos_35_vl,aes(x=Residue,y=Pheno))
?ggboxplot
ggboxplot(data = pos_35_vl,aes(x=Residue,y=Pheno))
ggboxplot(data = pos_35_vl,x=Residue,y=Pheno)
pos_35_vl$Residue
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno')
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno')
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = my_comparisons,method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3)
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3)
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3)
nrow(pos_35_R)
pos_35_vl <- rbind(data.frame(Pheno = pos_35_G$viralload_merged_invnormal_residual - mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = 'Gly',BLOSUM = BLOSUM80["G","G"]),
data.frame(Pheno = pos_35_K$viralload_merged_invnormal_residual- mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = 'Lys',BLOSUM = BLOSUM80["G","K"]),
data.frame(Pheno = pos_35_R$viralload_merged_invnormal_residual- mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = 'Arg',BLOSUM = BLOSUM80["G","R"]))
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3)
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3)
ggboxplot(data = pos_35_vl,x='BLOSUM',y='Pheno') + stat_compare_means(method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3)
ggboxplot(data = pos_35_vl,x='BLOSUM',y='Pheno') + stat_compare_means(method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3)
pos_35_vl <- rbind(data.frame(Pheno = pos_35_G$viralload_merged_invnormal_residual - mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = 'Gly',BLOSUM = BLOSUM80["R","G"]),
data.frame(Pheno = pos_35_K$viralload_merged_invnormal_residual- mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = 'Lys',BLOSUM = BLOSUM80["R","K"]),
data.frame(Pheno = pos_35_R$viralload_merged_invnormal_residual- mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = 'Arg',BLOSUM = BLOSUM80["R","R"]))
ggboxplot(data = pos_35_vl,x='BLOSUM',y='Pheno') + stat_compare_means(method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3)
ggboxplot(data = pos_35_vl,x='BLOSUM',y='Pheno') + stat_compare_means(method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3)
ggboxplot(data = pos_35_vl,x='BLOSUM',y='Pheno') + stat_compare_means(comparisons = list(c("Gly", "Lys"), c("Gly", "Arg"), c("Lys", "Arg")),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3)
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c("Gly", "Lys"), c("Gly", "Arg"), c("Lys", "Arg")),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3)
BLOSUM80["R","G"]
pos_35_vl <- rbind(data.frame(Pheno = pos_35_G$viralload_merged_invnormal_residual - mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = paste0('Gly (BLOSUM = ',BLOSUM80["R","G"],')')),
data.frame(Pheno = pos_35_K$viralload_merged_invnormal_residual- mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = paste0('Lys (BLOSUM = ',BLOSUM80["R","K"],')')),
data.frame(Pheno = pos_35_R$viralload_merged_invnormal_residual- mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = paste0('Arg (BLOSUM = ',BLOSUM80["R","R"],')')))
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c("Gly", "Lys"), c("Gly", "Arg"), c("Lys", "Arg")),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3)
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c("Gly", "Lys"), c("Gly", "Arg"), c("Lys", "Arg")),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3)
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c("Gly", "Lys"), c("Gly", "Arg"), c("Lys", "Arg")),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load')
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c("Gly", "Lys"), c("Gly", "Arg"), c("Lys", "Arg")),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load')
Gly_String_Pos_35 <- paste0('Gly (BLOSUM = ',BLOSUM80["R","G"],')')
Lys_String_Pos_35 <- paste0('Lys (BLOSUM = ',BLOSUM80["R","K"],')')
Arg_String_Pos_35 <- paste0('Arg (BLOSUM = ',BLOSUM80["R","R"],')')
pos_35_vl <- rbind(data.frame(Pheno = pos_35_G$viralload_merged_invnormal_residual - mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = Gly_String_Pos_35),
data.frame(Pheno = pos_35_K$viralload_merged_invnormal_residual- mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = Lys_String_Pos_35),
data.frame(Pheno = pos_35_R$viralload_merged_invnormal_residual- mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = Arg_String_Pos_35))
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load')
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load')
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35),c(Lys_String_Pos_35, Arg_String_Pos_35),c(Gly_String_Pos_35, Arg_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load')
pos_35_alt <- rbind(data.frame(Pheno = pos_35_G$ALT_level_invnormal_residual - mean(pos_35$ALT_level_invnormal_residual,na.rm=T),Residue = Gly_String_Pos_35),
data.frame(Pheno = pos_35_K$ALT_level_invnormal_residual- mean(pos_35$ALT_level_invnormal_residual,na.rm=T),Residue = Lys_String_Pos_35),
data.frame(Pheno = pos_35_R$ALT_level_invnormal_residual- mean(pos_35$ALT_level_invnormal_residual,na.rm=T),Residue = Arg_String_Pos_35))
ggboxplot(data = pos_35_alt,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35),c(Lys_String_Pos_35, Arg_String_Pos_35),c(Gly_String_Pos_35, Arg_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('ALT')
ggboxplot(data = pos_35_alt,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35),c(Lys_String_Pos_35, Arg_String_Pos_35),c(Gly_String_Pos_35, Arg_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('ALT')
p1 = ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35),c(Lys_String_Pos_35, Arg_String_Pos_35),c(Gly_String_Pos_35, Arg_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load')
p2 = ggboxplot(data = pos_35_alt,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35),c(Lys_String_Pos_35, Arg_String_Pos_35),c(Gly_String_Pos_35, Arg_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('ALT')
p1
p2
pos_35_sa <- rbind(data.frame(Pheno = pos_35_G$surface_antigen_invnormal_residual - mean(pos_35$surface_antigen_invnormal_residual,na.rm=T),Residue = Gly_String_Pos_35),
data.frame(Pheno = pos_35_K$surface_antigen_invnormal_residual- mean(pos_35$surface_antigen_invnormal_residual,na.rm=T),Residue = Lys_String_Pos_35),
data.frame(Pheno = pos_35_R$surface_antigen_invnormal_residual- mean(pos_35$surface_antigen_invnormal_residual,na.rm=T),Residue = Arg_String_Pos_35))
p3 = ggboxplot(data = pos_35_sa,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35),c(Lys_String_Pos_35, Arg_String_Pos_35),c(Gly_String_Pos_35, Arg_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('HBsAg')
p3 = ggboxplot(data = pos_35_sa,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35),c(Lys_String_Pos_35, Arg_String_Pos_35),c(Gly_String_Pos_35, Arg_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('HBsAg')
p3
apply(pos_51,2,sum)
pos_51 <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,rs2296651 == 0)
pos_51_H <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_H==1 & rs2296651 == 0)
pos_51_N <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_N==1 & rs2296651 == 0)
pos_51_P <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_P==1 & rs2296651 == 0)
pos_51_Q <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_Q==1 & rs2296651 == 0)
apply(pos_51,2,sum)
pos_51
nrow(pos_51_P)
nrow(pos_51_H)
nrow(pos_51_N)
nrow(pos_51_P)
nrow(pos_51_Q)
His_String_Pos_51 <- paste0('His (BLOSUM = ',BLOSUM80["P","H"],')')
Asn_String_Pos_51 <- paste0('Asn (BLOSUM = ',BLOSUM80["P","N"],')')
Pro_String_Pos_51 <- paste0('Pro (BLOSUM = ',BLOSUM80["P","P"],')')
Gln_String_Pos_51 <- paste0('Gln (BLOSUM = ',BLOSUM80["P","Q"],')')
His_String_Pos_51
ggboxplot(data = pos_51_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Pro_String_Pos_51),c(Asn_String_Pos_51, Pro_String_Pos_51),c(Gln_String_Pos_51, Pro_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load')
pos_51_vl <- rbind(data.frame(Pheno = pos_51_H$viralload_merged_invnormal_residual - mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = His_String_Pos_51),
data.frame(Pheno = pos_51_N$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Asn_String_Pos_51),
data.frame(Pheno = pos_51_P$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Pro_String_Pos_51),
data.frame(Pheno = pos_51_Q$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Gln_String_Pos_51))
pos_51 <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,rs2296651 == 0)
pos_51_H <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_H==1 & rs2296651 == 0)
pos_51_N <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_N==1 & rs2296651 == 0)
pos_51_P <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_P==1 & rs2296651 == 0)
pos_51_Q <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_Q==1 & rs2296651 == 0)
His_String_Pos_51 <- paste0('His (BLOSUM = ',BLOSUM80["P","H"],')')
Asn_String_Pos_51 <- paste0('Asn (BLOSUM = ',BLOSUM80["P","N"],')')
Pro_String_Pos_51 <- paste0('Pro (BLOSUM = ',BLOSUM80["P","P"],')')
Gln_String_Pos_51 <- paste0('Gln (BLOSUM = ',BLOSUM80["P","Q"],')')
pos_51_vl <- rbind(data.frame(Pheno = pos_51_H$viralload_merged_invnormal_residual - mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = His_String_Pos_51),
data.frame(Pheno = pos_51_N$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Asn_String_Pos_51),
data.frame(Pheno = pos_51_P$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Pro_String_Pos_51),
data.frame(Pheno = pos_51_Q$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Gln_String_Pos_51))
ggboxplot(data = pos_51_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Pro_String_Pos_51),c(Asn_String_Pos_51, Pro_String_Pos_51),c(Gln_String_Pos_51, Pro_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load')
ggboxplot(data = pos_51_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Pro_String_Pos_51),c(Asn_String_Pos_51, Pro_String_Pos_51),c(Gln_String_Pos_51, Pro_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load')
pos_51_vl <- rbind(data.frame(Pheno = pos_51_H$viralload_merged_invnormal_residual - mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = His_String_Pos_51),
data.frame(Pheno = pos_51_N$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Asn_String_Pos_51),
data.frame(Pheno = pos_51_Q$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Gln_String_Pos_51),
data.frame(Pheno = pos_51_P$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Pro_String_Pos_51))
ggboxplot(data = pos_51_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Pro_String_Pos_51),c(Asn_String_Pos_51, Pro_String_Pos_51),c(Gln_String_Pos_51, Pro_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load')
ggboxplot(data = pos_51_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Asn_String_Pos_51),c(His_String_Pos_51, Gln_String_Pos_51),c(Asn_String_Pos_51, Gln_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load')
pos_51_alt <- rbind(data.frame(Pheno = pos_51_H$ALT_level_invnormal_residual - mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = His_String_Pos_51),
data.frame(Pheno = pos_51_N$ALT_level_invnormal_residual- mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = Asn_String_Pos_51),
data.frame(Pheno = pos_51_Q$ALT_level_invnormal_residual- mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = Gln_String_Pos_51),
data.frame(Pheno = pos_51_P$ALT_level_invnormal_residual- mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = Pro_String_Pos_51))
pos_51_alt <- rbind(data.frame(Pheno = pos_51_H$ALT_level_invnormal_residual - mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = His_String_Pos_51),
data.frame(Pheno = pos_51_N$ALT_level_invnormal_residual- mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = Asn_String_Pos_51),
data.frame(Pheno = pos_51_Q$ALT_level_invnormal_residual- mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = Gln_String_Pos_51),
data.frame(Pheno = pos_51_P$ALT_level_invnormal_residual- mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = Pro_String_Pos_51))
p5 = ggboxplot(data = pos_51_alt,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Asn_String_Pos_51),c(His_String_Pos_51, Gln_String_Pos_51),c(Asn_String_Pos_51, Gln_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('ALT')
p6 = ggboxplot(data = pos_51_alt,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Asn_String_Pos_51),c(His_String_Pos_51, Gln_String_Pos_51),c(Asn_String_Pos_51, Gln_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('HBsAg')
pos_51_sa <- rbind(data.frame(Pheno = pos_51_H$surface_antigen_invnormal_residual - mean(pos_51$surface_antigen_invnormal_residual,na.rm=T),Residue = His_String_Pos_51),
data.frame(Pheno = pos_51_N$surface_antigen_invnormal_residual- mean(pos_51$surface_antigen_invnormal_residual,na.rm=T),Residue = Asn_String_Pos_51),
data.frame(Pheno = pos_51_Q$surface_antigen_invnormal_residual- mean(pos_51$surface_antigen_invnormal_residual,na.rm=T),Residue = Gln_String_Pos_51),
data.frame(Pheno = pos_51_P$surface_antigen_invnormal_residual- mean(pos_51$surface_antigen_invnormal_residual,na.rm=T),Residue = Pro_String_Pos_51))
p6 = ggboxplot(data = pos_51_alt,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Asn_String_Pos_51),c(His_String_Pos_51, Gln_String_Pos_51),c(Asn_String_Pos_51, Gln_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('HBsAg')
ggpubr::ggarrange(p1,p2,p3,p4,p5,p6,ncol=2,nrow=3)
ggpubr::ggarrange(p1,p2,p3,p4,p5,p6,ncol=2,nrow=3)
pos_35 <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,rs2296651 == 0)
pos_35_G <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0035_G==1 & rs2296651 == 0)
pos_35_K <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0035_K==1 & rs2296651 == 0)
pos_35_R <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0035_R==1 & rs2296651 == 0)
Gly_String_Pos_35 <- paste0('Gly (BLOSUM = ',BLOSUM80["R","G"],')')
Lys_String_Pos_35 <- paste0('Lys (BLOSUM = ',BLOSUM80["R","K"],')')
Arg_String_Pos_35 <- paste0('Arg (BLOSUM = ',BLOSUM80["R","R"],')')
pos_35_vl <- rbind(data.frame(Pheno = pos_35_G$viralload_merged_invnormal_residual - mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = Gly_String_Pos_35),
data.frame(Pheno = pos_35_K$viralload_merged_invnormal_residual- mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = Lys_String_Pos_35),
data.frame(Pheno = pos_35_R$viralload_merged_invnormal_residual- mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = Arg_String_Pos_35))
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35),c(Lys_String_Pos_35, Arg_String_Pos_35),c(Gly_String_Pos_35, Arg_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load')
pos_35_alt <- rbind(data.frame(Pheno = pos_35_G$ALT_level_invnormal_residual - mean(pos_35$ALT_level_invnormal_residual,na.rm=T),Residue = Gly_String_Pos_35),
data.frame(Pheno = pos_35_K$ALT_level_invnormal_residual- mean(pos_35$ALT_level_invnormal_residual,na.rm=T),Residue = Lys_String_Pos_35),
data.frame(Pheno = pos_35_R$ALT_level_invnormal_residual- mean(pos_35$ALT_level_invnormal_residual,na.rm=T),Residue = Arg_String_Pos_35))
pos_35_sa <- rbind(data.frame(Pheno = pos_35_G$surface_antigen_invnormal_residual - mean(pos_35$surface_antigen_invnormal_residual,na.rm=T),Residue = Gly_String_Pos_35),
data.frame(Pheno = pos_35_K$surface_antigen_invnormal_residual- mean(pos_35$surface_antigen_invnormal_residual,na.rm=T),Residue = Lys_String_Pos_35),
data.frame(Pheno = pos_35_R$surface_antigen_invnormal_residual- mean(pos_35$surface_antigen_invnormal_residual,na.rm=T),Residue = Arg_String_Pos_35))
p1 = ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35),c(Lys_String_Pos_35, Arg_String_Pos_35),c(Gly_String_Pos_35, Arg_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load')
p2 = ggboxplot(data = pos_35_alt,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35),c(Lys_String_Pos_35, Arg_String_Pos_35),c(Gly_String_Pos_35, Arg_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('ALT')
p3 = ggboxplot(data = pos_35_sa,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35),c(Lys_String_Pos_35, Arg_String_Pos_35),c(Gly_String_Pos_35, Arg_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('HBsAg')
pos_51 <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,rs2296651 == 0)
pos_51_H <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_H==1 & rs2296651 == 0)
pos_51_N <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_N==1 & rs2296651 == 0)
pos_51_P <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_P==1 & rs2296651 == 0)
pos_51_Q <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_Q==1 & rs2296651 == 0)
His_String_Pos_51 <- paste0('His (BLOSUM = ',BLOSUM80["P","H"],')')
Asn_String_Pos_51 <- paste0('Asn (BLOSUM = ',BLOSUM80["P","N"],')')
Gln_String_Pos_51 <- paste0('Gln (BLOSUM = ',BLOSUM80["P","Q"],')')
Pro_String_Pos_51 <- paste0('Pro (BLOSUM = ',BLOSUM80["P","P"],')')
pos_51_vl <- rbind(data.frame(Pheno = pos_51_H$viralload_merged_invnormal_residual - mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = His_String_Pos_51),
data.frame(Pheno = pos_51_N$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Asn_String_Pos_51),
data.frame(Pheno = pos_51_Q$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Gln_String_Pos_51),
data.frame(Pheno = pos_51_P$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Pro_String_Pos_51))
p4 = ggboxplot(data = pos_51_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Asn_String_Pos_51),c(His_String_Pos_51, Gln_String_Pos_51),c(Asn_String_Pos_51, Gln_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load')
pos_51_alt <- rbind(data.frame(Pheno = pos_51_H$ALT_level_invnormal_residual - mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = His_String_Pos_51),
data.frame(Pheno = pos_51_N$ALT_level_invnormal_residual- mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = Asn_String_Pos_51),
data.frame(Pheno = pos_51_Q$ALT_level_invnormal_residual- mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = Gln_String_Pos_51),
data.frame(Pheno = pos_51_P$ALT_level_invnormal_residual- mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = Pro_String_Pos_51))
p5 = ggboxplot(data = pos_51_alt,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Asn_String_Pos_51),c(His_String_Pos_51, Gln_String_Pos_51),c(Asn_String_Pos_51, Gln_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('ALT')
pos_51_sa <- rbind(data.frame(Pheno = pos_51_H$surface_antigen_invnormal_residual - mean(pos_51$surface_antigen_invnormal_residual,na.rm=T),Residue = His_String_Pos_51),
data.frame(Pheno = pos_51_N$surface_antigen_invnormal_residual- mean(pos_51$surface_antigen_invnormal_residual,na.rm=T),Residue = Asn_String_Pos_51),
data.frame(Pheno = pos_51_Q$surface_antigen_invnormal_residual- mean(pos_51$surface_antigen_invnormal_residual,na.rm=T),Residue = Gln_String_Pos_51),
data.frame(Pheno = pos_51_P$surface_antigen_invnormal_residual- mean(pos_51$surface_antigen_invnormal_residual,na.rm=T),Residue = Pro_String_Pos_51))
p6 = ggboxplot(data = pos_51_alt,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Asn_String_Pos_51),c(His_String_Pos_51, Gln_String_Pos_51),c(Asn_String_Pos_51, Gln_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('HBsAg')
ggpubr::ggarrange(p1,p2,p3,p4,p5,p6,ncol=2,nrow=3)
ggpubr::ggarrange(p1,p4,p2,p5,p3,p6,ncol=2,nrow=3)
p1 = ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35),c(Lys_String_Pos_35, Arg_String_Pos_35),c(Gly_String_Pos_35, Arg_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load') + ggtitle('PreS1 (Pos 35)')
p2 = ggboxplot(data = pos_35_alt,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35),c(Lys_String_Pos_35, Arg_String_Pos_35),c(Gly_String_Pos_35, Arg_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('ALT')
p3 = ggboxplot(data = pos_35_sa,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35),c(Lys_String_Pos_35, Arg_String_Pos_35),c(Gly_String_Pos_35, Arg_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('HBsAg')
pos_51 <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,rs2296651 == 0)
pos_51_H <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_H==1 & rs2296651 == 0)
pos_51_N <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_N==1 & rs2296651 == 0)
pos_51_P <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_P==1 & rs2296651 == 0)
pos_51_Q <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_Q==1 & rs2296651 == 0)
His_String_Pos_51 <- paste0('His (BLOSUM = ',BLOSUM80["P","H"],')')
Asn_String_Pos_51 <- paste0('Asn (BLOSUM = ',BLOSUM80["P","N"],')')
Gln_String_Pos_51 <- paste0('Gln (BLOSUM = ',BLOSUM80["P","Q"],')')
Pro_String_Pos_51 <- paste0('Pro (BLOSUM = ',BLOSUM80["P","P"],')')
pos_51_vl <- rbind(data.frame(Pheno = pos_51_H$viralload_merged_invnormal_residual - mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = His_String_Pos_51),
data.frame(Pheno = pos_51_N$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Asn_String_Pos_51),
data.frame(Pheno = pos_51_Q$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Gln_String_Pos_51),
data.frame(Pheno = pos_51_P$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Pro_String_Pos_51))
p4 = ggboxplot(data = pos_51_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Asn_String_Pos_51),c(His_String_Pos_51, Gln_String_Pos_51),c(Asn_String_Pos_51, Gln_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load') + ggtitle('PreS1 (Pos 51)')
pos_51_alt <- rbind(data.frame(Pheno = pos_51_H$ALT_level_invnormal_residual - mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = His_String_Pos_51),
data.frame(Pheno = pos_51_N$ALT_level_invnormal_residual- mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = Asn_String_Pos_51),
data.frame(Pheno = pos_51_Q$ALT_level_invnormal_residual- mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = Gln_String_Pos_51),
data.frame(Pheno = pos_51_P$ALT_level_invnormal_residual- mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = Pro_String_Pos_51))
p5 = ggboxplot(data = pos_51_alt,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Asn_String_Pos_51),c(His_String_Pos_51, Gln_String_Pos_51),c(Asn_String_Pos_51, Gln_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('ALT')
pos_51_sa <- rbind(data.frame(Pheno = pos_51_H$surface_antigen_invnormal_residual - mean(pos_51$surface_antigen_invnormal_residual,na.rm=T),Residue = His_String_Pos_51),
data.frame(Pheno = pos_51_N$surface_antigen_invnormal_residual- mean(pos_51$surface_antigen_invnormal_residual,na.rm=T),Residue = Asn_String_Pos_51),
data.frame(Pheno = pos_51_Q$surface_antigen_invnormal_residual- mean(pos_51$surface_antigen_invnormal_residual,na.rm=T),Residue = Gln_String_Pos_51),
data.frame(Pheno = pos_51_P$surface_antigen_invnormal_residual- mean(pos_51$surface_antigen_invnormal_residual,na.rm=T),Residue = Pro_String_Pos_51))
p6 = ggboxplot(data = pos_51_alt,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Asn_String_Pos_51),c(His_String_Pos_51, Gln_String_Pos_51),c(Asn_String_Pos_51, Gln_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('HBsAg')
ggpubr::ggarrange(p1,p4,p2,p5,p3,p6,ncol=2,nrow=3)
library(Biostrings)
data(BLOSUM80)
pos_35 <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,rs2296651 == 0)
pos_35_G <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0035_G==1 & rs2296651 == 0)
pos_35_K <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0035_K==1 & rs2296651 == 0)
pos_35_R <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0035_R==1 & rs2296651 == 0)
Gly_String_Pos_35 <- paste0('Gly (BLOSUM = ',BLOSUM80["R","G"],')')
Lys_String_Pos_35 <- paste0('Lys (BLOSUM = ',BLOSUM80["R","K"],')')
Arg_String_Pos_35 <- paste0('Arg (BLOSUM = ',BLOSUM80["R","R"],')')
pos_35_vl <- rbind(data.frame(Pheno = pos_35_G$viralload_merged_invnormal_residual - mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = Gly_String_Pos_35),
data.frame(Pheno = pos_35_K$viralload_merged_invnormal_residual- mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = Lys_String_Pos_35),
data.frame(Pheno = pos_35_R$viralload_merged_invnormal_residual- mean(pos_35$viralload_merged_invnormal_residual,na.rm=T),Residue = Arg_String_Pos_35))
ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35),c(Lys_String_Pos_35, Arg_String_Pos_35),c(Gly_String_Pos_35, Arg_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load')
pos_35_alt <- rbind(data.frame(Pheno = pos_35_G$ALT_level_invnormal_residual - mean(pos_35$ALT_level_invnormal_residual,na.rm=T),Residue = Gly_String_Pos_35),
data.frame(Pheno = pos_35_K$ALT_level_invnormal_residual- mean(pos_35$ALT_level_invnormal_residual,na.rm=T),Residue = Lys_String_Pos_35),
data.frame(Pheno = pos_35_R$ALT_level_invnormal_residual- mean(pos_35$ALT_level_invnormal_residual,na.rm=T),Residue = Arg_String_Pos_35))
pos_35_sa <- rbind(data.frame(Pheno = pos_35_G$surface_antigen_invnormal_residual - mean(pos_35$surface_antigen_invnormal_residual,na.rm=T),Residue = Gly_String_Pos_35),
data.frame(Pheno = pos_35_K$surface_antigen_invnormal_residual- mean(pos_35$surface_antigen_invnormal_residual,na.rm=T),Residue = Lys_String_Pos_35),
data.frame(Pheno = pos_35_R$surface_antigen_invnormal_residual- mean(pos_35$surface_antigen_invnormal_residual,na.rm=T),Residue = Arg_String_Pos_35))
p1 = ggboxplot(data = pos_35_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load') + ggtitle('PreS1 (Pos 35)')
p2 = ggboxplot(data = pos_35_alt,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('ALT')
p3 = ggboxplot(data = pos_35_sa,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(Gly_String_Pos_35, Lys_String_Pos_35)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('HBsAg')
pos_51 <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,rs2296651 == 0)
pos_51_H <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_H==1 & rs2296651 == 0)
pos_51_N <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_N==1 & rs2296651 == 0)
pos_51_P <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_P==1 & rs2296651 == 0)
pos_51_Q <- dplyr::filter(dat_pheno_cov_dosage_tbl_recode,gene_S_pos_0051_Q==1 & rs2296651 == 0)
His_String_Pos_51 <- paste0('His (BLOSUM = ',BLOSUM80["P","H"],')')
Asn_String_Pos_51 <- paste0('Asn (BLOSUM = ',BLOSUM80["P","N"],')')
Gln_String_Pos_51 <- paste0('Gln (BLOSUM = ',BLOSUM80["P","Q"],')')
Pro_String_Pos_51 <- paste0('Pro (BLOSUM = ',BLOSUM80["P","P"],')')
pos_51_vl <- rbind(data.frame(Pheno = pos_51_H$viralload_merged_invnormal_residual - mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = His_String_Pos_51),
data.frame(Pheno = pos_51_N$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Asn_String_Pos_51),
data.frame(Pheno = pos_51_Q$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Gln_String_Pos_51),
data.frame(Pheno = pos_51_P$viralload_merged_invnormal_residual- mean(pos_51$viralload_merged_invnormal_residual,na.rm=T),Residue = Pro_String_Pos_51))
p4 = ggboxplot(data = pos_51_vl,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Asn_String_Pos_51),c(His_String_Pos_51, Gln_String_Pos_51),c(Asn_String_Pos_51, Gln_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('Viral Load') + ggtitle('PreS1 (Pos 51)')
pos_51_alt <- rbind(data.frame(Pheno = pos_51_H$ALT_level_invnormal_residual - mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = His_String_Pos_51),
data.frame(Pheno = pos_51_N$ALT_level_invnormal_residual- mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = Asn_String_Pos_51),
data.frame(Pheno = pos_51_Q$ALT_level_invnormal_residual- mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = Gln_String_Pos_51),
data.frame(Pheno = pos_51_P$ALT_level_invnormal_residual- mean(pos_51$ALT_level_invnormal_residual,na.rm=T),Residue = Pro_String_Pos_51))
p5 = ggboxplot(data = pos_51_alt,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Asn_String_Pos_51),c(His_String_Pos_51, Gln_String_Pos_51),c(Asn_String_Pos_51, Gln_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('ALT')
pos_51_sa <- rbind(data.frame(Pheno = pos_51_H$surface_antigen_invnormal_residual - mean(pos_51$surface_antigen_invnormal_residual,na.rm=T),Residue = His_String_Pos_51),
data.frame(Pheno = pos_51_N$surface_antigen_invnormal_residual- mean(pos_51$surface_antigen_invnormal_residual,na.rm=T),Residue = Asn_String_Pos_51),
data.frame(Pheno = pos_51_Q$surface_antigen_invnormal_residual- mean(pos_51$surface_antigen_invnormal_residual,na.rm=T),Residue = Gln_String_Pos_51),
data.frame(Pheno = pos_51_P$surface_antigen_invnormal_residual- mean(pos_51$surface_antigen_invnormal_residual,na.rm=T),Residue = Pro_String_Pos_51))
p6 = ggboxplot(data = pos_51_alt,x='Residue',y='Pheno') + stat_compare_means(comparisons = list(c(His_String_Pos_51, Asn_String_Pos_51),c(His_String_Pos_51, Gln_String_Pos_51),c(Asn_String_Pos_51, Gln_String_Pos_51)),method = 't.test',size = 2.5) + xlab("") + stat_n_text(size=3) + ylab('HBsAg')
ggpubr::ggarrange(p1,p4,p2,p5,p3,p6,ncol=2,nrow=3)
ggpubr::ggarrange(p1,p4,p2,p5,p3,p6,ncol=2,nrow=3)
?stepAIC
source('~/.active-rstudio-document', echo=TRUE)
surve_cph
train_coxph
dat
?rbgen::bgen.load
?rbgen::bgen.load
install.packages("rbgen")
source('~/Documents/Genetic_Epi_BSU_Project/SummaryStatsInt.R')
setwd("~/Documents/Genetic_Epi_BSU_Project")
source('~/Documents/Genetic_Epi_BSU_Project/SummaryStatsInt.R')
head(int_results)
which(snp_info$alleleB_frequency != snp_info$minor_allele_frequency)
snp_info[129,]
0.46 * 0.46
0.53 * 0.53
snp_info[17120,]
int_results <- dplyr::left_join(int_results,snp_info %>% dplyr::select(rsid,chromosome,position,alleleA,alleleB,alleleB_frequency,info),by=c('rsid'='rsid'))
int_results
?dplyr::arrange
int_results <- dplyr::arrange(int_results,chromosome,position)
int_results
min(int_results$p_int)
which.min(int_results$p_int)
#Excl HMGCR
chr <- 5
start_pos <- 74632154 - 2e6
end_pos <- 74657929 + 2e6
int_results <- int_results %>% dplyr::filter(!(chromosome == chr & position > start_pos & position < end_pos))
head(int_results)
which.min(int_results$p_int)
min(int_results$p_int)
int_results[1627228,]
head(snp_info)
table(snp_info$total)
unique(snp_info$total)
#Encode into required format
int_results <- dplyr::select(int_results,SNP = rsid,CHR = chromosome,POS = position, A1 = alleleA, A2 = alleleB, `A1/A2` = 'A1', EAF = alleleB_frequency, Beta = coeff_int,se = std_err_int,P = p_int,N = 232419,INFO = info)
#Encode into required format
int_results <- dplyr::select(int_results,SNP = rsid,CHR = chromosome,POS = position, A1 = alleleA, A2 = alleleB, EAF = alleleB_frequency, Beta = coeff_int,se = std_err_int,P = p_int,INFO = info)
int_results <- dplyr::mutate(`A1/A2` = 'A1',N = 232419)
int_results <- dplyr::mutate(int_results,`A1/A2` = 'A1',N = 232419)
int_results
int_results[,c('SNP','CHR','POS','A1','A2','A1/A2','EAF','Beta','se','P','INFO','N')]
data.table::fwrite(int_results[,c('SNP','CHR','POS','A1','A2','A1/A2','EAF','Beta','se','P','INFO','N')],file = '~/Documents/Genetic_Epi_BSU_Project/gepi_22347_summary_stats',sep = ' ',quote = F,row.names = F,col.names = T)
data.table::fwrite(int_results[,c('SNP','CHR','POS','A1','A2','A1/A2','EAF','Beta','se','P','INFO','N')],file = '~/Documents/Genetic_Epi_BSU_Project/gepi_22347_summary_stats',sep = '\t',quote = F,row.names = F,col.names = T)
data.table::fwrite(int_results[,c('SNP','CHR','POS','A1','A2','A1/A2','EAF','Beta','se','P','INFO','N')],file = '~/Documents/Genetic_Epi_BSU_Project/gepi_22347_summary_stats.tsv',sep = '\t',quote = F,row.names = F,col.names = T)
setwd("~/Documents/polyresponse/Variant_Quality")
